"use strict";

sap.ui.define(["./BaseController", "sap/ui/core/Fragment", "sap/ui/model/json/JSONModel", "sap/m/MessageToast"], function (__BaseController, Fragment, JSONModel, MessageToast) {
  "use strict";

  function _interopRequireDefault(obj) {
    return obj && obj.__esModule && typeof obj.default !== "undefined" ? obj.default : obj;
  }
  const BaseController = _interopRequireDefault(__BaseController);
  /**
   * @namespace mrg.sample.controller
   */
  const Main = BaseController.extend("mrg.sample.controller.Main", {
    constructor: function constructor() {
      BaseController.prototype.constructor.apply(this, arguments);
      this.aTerritoryIds = [];
      this.oModifiedItems = {};
    },
    onInit: function _onInit() {
      // Initialize with create fragment
      void this.loadFragments('Create');

      // Get I18n
      const i18nModel = this.getOwnerComponent().getModel("i18n");
      this.oResourceBundle = i18nModel.getResourceBundle();

      // Create local model to serve as template for creation of OData entries
      const oDataModel = new JSONModel({
        TerritoryID: '',
        TerritoryDescription: '',
        RegionID: 0
      });
      this.getView()?.setModel(oDataModel, 'oModel');
      this.bCreation = true;
    },
    onAfterRendering: function _onAfterRendering() {
      // This method was done here because oItemsBinding was undefined if view wasn't rendered
      // Get the binding of type V2.ODataListBinding form the table
      this.onGetTerritoryIds();
    },
    onGetTerritoryIds: function _onGetTerritoryIds() {
      const oItemsBinding = (this.getView()?.byId('mainPageTable')).getBinding('items');

      // When we receive the data on the table execute onCreateActiveEntry
      oItemsBinding.attachDataReceived(oEvent => {
        this.aTerritoryIds = oItemsBinding.getContexts().map(oContext => oContext.getPath());
      });
    },
    loadFragments: async function _loadFragments(fragmentName) {
      const oSimpleForm = this.byId('mainSimpleForm');
      const oPanel = this.byId('mainPagePanelForm');
      oPanel.setBusy(true);
      oSimpleForm.destroyContent(); // Clear everything when a new fragment is to be loaded

      try {
        const aControl = await Fragment.load({
          name: 'mrg.sample.view.fragments.' + fragmentName,
          controller: this
        });
        aControl.forEach(oControl => {
          oSimpleForm.addContent(oControl);
        });
      } catch (oError) {
        console.error(`Error loading fragment ${fragmentName}:`, oError);
      } finally {
        oPanel.setBusy(false);
      }
    },
    onPressItem: function _onPressItem(oEvent) {
      // Get the index of the item we have selected on the table
      const sSelectedPath = oEvent.getSource().getBindingContext('Northwind')?.getPath();
      (this.getView()?.byId('mainPageTable')).getBinding('items')?.getContexts().forEach((oContext, i) => {
        if (oContext.getPath() === sSelectedPath) {
          this.iIndex = i;
        }
      });

      // bind the context on the Edit panel and load fragment
      this.selectedContext = oEvent.getSource().getBindingContext('Northwind');
      this.onEdit(oEvent);
      this.byId('mainPagePanelForm').setExpanded(true);

      // Once the item is pressed, scroll up to the panel
      this.byId('mainPage').scrollToElement(this.byId('mainPagePanelForm'));
    },
    onCreateDraft: function _onCreateDraft() {
      this.onCreateInactive(true);
    },
    onCreateEntry: function _onCreateEntry() {
      this.onCreateInactive(false);
    },
    onCreateInactive: function _onCreateInactive(bActive) {
      // If we are on edit mode, return to create mode
      if (!this.bCreation) {
        // Clear the oModel attached to the Create fragment and load the Create panel
        (this.getView()?.getModel('oModel')).setData({
          TerritoryID: '',
          TerritoryDescription: '',
          RegionID: 0
        });
        this.loadFragments('Create');

        // Read i18n Texts
        const sNewPanelHeader = this.oResourceBundle.getText('creationPanel');
        const sNewBtnTextDraft = this.oResourceBundle.getText('addEntryDraft');

        // Set texts on header and buttons
        const oBtnDraft = this.byId('createDraftBtn');
        const oBtnCreate = this.byId('createEntryBtn');
        this.byId('mainPagePanelForm').setHeaderText(sNewPanelHeader);
        oBtnDraft.setText(sNewBtnTextDraft);
        oBtnDraft.setIcon('sap-icon://add');
        oBtnCreate.setVisible(true);
        this.byId('saveEntityBtn').setVisible(false);

        // Clear context and set mode: create
        this.selectedContext = undefined;
        this.bCreation = true;
        return;
      }

      // Check ID is filled in
      const oDataPrecheck = (this.getView()?.getModel('oModel')).getData();
      if (oDataPrecheck?.TerritoryID === '' || oDataPrecheck?.TerritoryID === undefined) {
        /* 			MessageToast.show('Territory Id mandatory to be supplied!');
        			return; */
      }
      if (this.aTerritoryIds.includes(`/Territories('${oDataPrecheck.TerritoryID}')`)) {
        MessageToast.show('Territory Id already exists!');
        return;
      } else {
        this.aTerritoryIds.push(`/Territories('${oDataPrecheck.TerritoryID}')`);
      }

      // On the table context add a new entry with the data from our Panel
      const oItemsBinding = (this.getView()?.byId('mainPageTable')).getBinding('items');
      const oNewEntryModel = this.getView()?.getModel('oModel');
      const oNewEntryObject = oNewEntryModel.getData();
      this.selectedContext = oItemsBinding.create(oNewEntryObject, true, {
        inactive: bActive
      });

      // Once the model is set to the table, clear input fields and display message
      this.getView()?.getModel('oModel')?.setData({
        TerritoryID: '',
        TerritoryDescription: '',
        RegionID: 0
      });
      MessageToast.show('Entry created successfully!');

      // Highlight created entry and add its position into this.oModofiedItems
      const aItems = this.byId('mainPageTable').getItems();
      const iLastItemIndex = aItems.length - 1;
      const oLastColumnListItem = aItems[iLastItemIndex];
      this.highlightItem(oLastColumnListItem, bActive ? 'Error' : 'None', iLastItemIndex, this.selectedContext.getPath());
    },
    onEdit: function _onEdit(oEvent) {
      // Bind the context of the current entry to the simple form
      if (this.selectedContext !== undefined) {
        this.byId('mainSimpleForm').setBindingContext(this.selectedContext, 'Northwind');
      } else {
        MessageToast.show('Please select an entry to be edited');
        return;
      }

      // Set the panel fragment for edition
      this.loadFragments('Edit');

      // Change texts, icons and hide buttons
      const sNewPanelHeader = this.oResourceBundle.getText('editionPanel');
      const sNewBtnText = this.oResourceBundle.getText('entryCreation');
      this.byId('mainPagePanelForm').setHeaderText(sNewPanelHeader);
      this.byId('saveEntityBtn').setVisible(true);
      this.byId('createEntryBtn').setVisible(false);
      const oBtn = this.byId('createDraftBtn');
      oBtn.setText(sNewBtnText);
      oBtn.setIcon('sap-icon://create');
      this.bCreation = false;
    },
    onSave: function _onSave() {
      // Object to be modified
      const oColumnListItem = this.byId('mainPageTable').getItems()[this.iIndex];
      const oData = this.selectedContext.getObject();
      const sPath = this.selectedContext.getPath();

      // Highlight this entry as modified and save information on this.oModifiedItems
      this.highlightItem(oColumnListItem, 'Error', this.iIndex, sPath);

      // oData holds the old data for this entry, we are going to update possible values 
      oData.TerritoryDescription = this.byId('territoryDescriptionInputEdit').getValue();
      oData.RegionID = this.byId('RegionInputEdit').getValue();

      // To activate the inactive entry, get the model and set a property to the same value
      const oNorthwindModel = this.getOwnerComponent().getModel('Northwind');
      oNorthwindModel.setProperty('TerritoryDescription', oData.TerritoryDescription, this.selectedContext, true);
      console.log(this.selectedContext.isInactive());
    },
    highlightItem: function _highlightItem(oItem, sMode, iIndex, sPath) {
      if (sMode !== 'Error' && sMode !== 'None') {
        throw new Error('sMode parameter has invalid value');
      }
      oItem.setHighlight(sMode);
      if (!Number.isNaN(iIndex)) {
        this.oModifiedItems[sPath] = {
          inactive: sMode === 'Error' ? true : false,
          tableIndex: iIndex
        };
        console.log(this.oModifiedItems);
      } else {
        throw new Error('iIndex is not a number');
      }
    },
    onSubmit: function _onSubmit() {
      const oNorthwindModel = this.getOwnerComponent().getModel('Northwind');
      oNorthwindModel.submitChanges();
    }
  });
  return Main;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCYXNlQ29udHJvbGxlciIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfX0Jhc2VDb250cm9sbGVyIiwiTWFpbiIsImV4dGVuZCIsImNvbnN0cnVjdG9yIiwicHJvdG90eXBlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJhVGVycml0b3J5SWRzIiwib01vZGlmaWVkSXRlbXMiLCJvbkluaXQiLCJfb25Jbml0IiwibG9hZEZyYWdtZW50cyIsImkxOG5Nb2RlbCIsImdldE93bmVyQ29tcG9uZW50IiwiZ2V0TW9kZWwiLCJvUmVzb3VyY2VCdW5kbGUiLCJnZXRSZXNvdXJjZUJ1bmRsZSIsIm9EYXRhTW9kZWwiLCJKU09OTW9kZWwiLCJUZXJyaXRvcnlJRCIsIlRlcnJpdG9yeURlc2NyaXB0aW9uIiwiUmVnaW9uSUQiLCJnZXRWaWV3Iiwic2V0TW9kZWwiLCJiQ3JlYXRpb24iLCJvbkFmdGVyUmVuZGVyaW5nIiwiX29uQWZ0ZXJSZW5kZXJpbmciLCJvbkdldFRlcnJpdG9yeUlkcyIsIl9vbkdldFRlcnJpdG9yeUlkcyIsIm9JdGVtc0JpbmRpbmciLCJieUlkIiwiZ2V0QmluZGluZyIsImF0dGFjaERhdGFSZWNlaXZlZCIsIm9FdmVudCIsImdldENvbnRleHRzIiwibWFwIiwib0NvbnRleHQiLCJnZXRQYXRoIiwiX2xvYWRGcmFnbWVudHMiLCJmcmFnbWVudE5hbWUiLCJvU2ltcGxlRm9ybSIsIm9QYW5lbCIsInNldEJ1c3kiLCJkZXN0cm95Q29udGVudCIsImFDb250cm9sIiwiRnJhZ21lbnQiLCJsb2FkIiwibmFtZSIsImNvbnRyb2xsZXIiLCJmb3JFYWNoIiwib0NvbnRyb2wiLCJhZGRDb250ZW50Iiwib0Vycm9yIiwiY29uc29sZSIsImVycm9yIiwib25QcmVzc0l0ZW0iLCJfb25QcmVzc0l0ZW0iLCJzU2VsZWN0ZWRQYXRoIiwiZ2V0U291cmNlIiwiZ2V0QmluZGluZ0NvbnRleHQiLCJpIiwiaUluZGV4Iiwic2VsZWN0ZWRDb250ZXh0Iiwib25FZGl0Iiwic2V0RXhwYW5kZWQiLCJzY3JvbGxUb0VsZW1lbnQiLCJvbkNyZWF0ZURyYWZ0IiwiX29uQ3JlYXRlRHJhZnQiLCJvbkNyZWF0ZUluYWN0aXZlIiwib25DcmVhdGVFbnRyeSIsIl9vbkNyZWF0ZUVudHJ5IiwiX29uQ3JlYXRlSW5hY3RpdmUiLCJiQWN0aXZlIiwic2V0RGF0YSIsInNOZXdQYW5lbEhlYWRlciIsImdldFRleHQiLCJzTmV3QnRuVGV4dERyYWZ0Iiwib0J0bkRyYWZ0Iiwib0J0bkNyZWF0ZSIsInNldEhlYWRlclRleHQiLCJzZXRUZXh0Iiwic2V0SWNvbiIsInNldFZpc2libGUiLCJ1bmRlZmluZWQiLCJvRGF0YVByZWNoZWNrIiwiZ2V0RGF0YSIsImluY2x1ZGVzIiwiTWVzc2FnZVRvYXN0Iiwic2hvdyIsInB1c2giLCJvTmV3RW50cnlNb2RlbCIsIm9OZXdFbnRyeU9iamVjdCIsImNyZWF0ZSIsImluYWN0aXZlIiwiYUl0ZW1zIiwiZ2V0SXRlbXMiLCJpTGFzdEl0ZW1JbmRleCIsImxlbmd0aCIsIm9MYXN0Q29sdW1uTGlzdEl0ZW0iLCJoaWdobGlnaHRJdGVtIiwiX29uRWRpdCIsInNldEJpbmRpbmdDb250ZXh0Iiwic05ld0J0blRleHQiLCJvQnRuIiwib25TYXZlIiwiX29uU2F2ZSIsIm9Db2x1bW5MaXN0SXRlbSIsIm9EYXRhIiwiZ2V0T2JqZWN0Iiwic1BhdGgiLCJnZXRWYWx1ZSIsIm9Ob3J0aHdpbmRNb2RlbCIsInNldFByb3BlcnR5IiwibG9nIiwiaXNJbmFjdGl2ZSIsIl9oaWdobGlnaHRJdGVtIiwib0l0ZW0iLCJzTW9kZSIsIkVycm9yIiwic2V0SGlnaGxpZ2h0IiwiTnVtYmVyIiwiaXNOYU4iLCJ0YWJsZUluZGV4Iiwib25TdWJtaXQiLCJfb25TdWJtaXQiLCJzdWJtaXRDaGFuZ2VzIl0sInNvdXJjZXMiOlsiTWFpbi5jb250cm9sbGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBFdmVudCBmcm9tIFwic2FwL3VpL2Jhc2UvRXZlbnRcIjtcbmltcG9ydCBCYXNlQ29udHJvbGxlciBmcm9tIFwiLi9CYXNlQ29udHJvbGxlclwiO1xuaW1wb3J0IENvbnRleHQgZnJvbSBcInNhcC91aS9tb2RlbC9vZGF0YS92Mi9Db250ZXh0XCI7XG5pbXBvcnQgU2ltcGxlRm9ybSBmcm9tIFwic2FwL3VpL2xheW91dC9mb3JtL1NpbXBsZUZvcm1cIjtcbmltcG9ydCBGcmFnbWVudCBmcm9tIFwic2FwL3VpL2NvcmUvRnJhZ21lbnRcIjtcbmltcG9ydCBDb250cm9sIGZyb20gXCJzYXAvdWkvY29yZS9Db250cm9sXCI7XG5pbXBvcnQgUmVzb3VyY2VNb2RlbCBmcm9tIFwic2FwL3VpL21vZGVsL3Jlc291cmNlL1Jlc291cmNlTW9kZWxcIjtcbmltcG9ydCBSZXNvdXJjZUJ1bmRsZSBmcm9tIFwic2FwL2Jhc2UvaTE4bi9SZXNvdXJjZUJ1bmRsZVwiO1xuaW1wb3J0IENvbHVtbkxpc3RJdGVtIGZyb20gXCJzYXAvbS9Db2x1bW5MaXN0SXRlbVwiO1xuaW1wb3J0IFBhbmVsIGZyb20gXCJzYXAvbS9QYW5lbFwiO1xuaW1wb3J0IEpTT05Nb2RlbCBmcm9tIFwic2FwL3VpL21vZGVsL2pzb24vSlNPTk1vZGVsXCI7XG5pbXBvcnQgTWVzc2FnZVRvYXN0IGZyb20gXCJzYXAvbS9NZXNzYWdlVG9hc3RcIjtcbmltcG9ydCBPRGF0YUxpc3RCaW5kaW5nIGZyb20gXCJzYXAvdWkvbW9kZWwvb2RhdGEvdjIvT0RhdGFMaXN0QmluZGluZ1wiO1xuaW1wb3J0IFRhYmxlIGZyb20gXCJzYXAvbS9UYWJsZVwiO1xuaW1wb3J0IFVJQ29tcG9uZW50IGZyb20gXCJzYXAvdWkvY29yZS9VSUNvbXBvbmVudFwiO1xuaW1wb3J0IEJ1dHRvbiBmcm9tIFwic2FwL20vQnV0dG9uXCI7XG5pbXBvcnQgUGFnZSBmcm9tIFwic2FwL20vUGFnZVwiO1xuaW1wb3J0IE9EYXRhTW9kZWwgZnJvbSBcInNhcC91aS9tb2RlbC9vZGF0YS92Mi9PRGF0YU1vZGVsXCI7XG5pbXBvcnQgSW5wdXQgZnJvbSBcInNhcC9tL0lucHV0XCI7XG5cbi8qKlxuICogQG5hbWVzcGFjZSBtcmcuc2FtcGxlLmNvbnRyb2xsZXJcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWFpbiBleHRlbmRzIEJhc2VDb250cm9sbGVyIHtcblx0cHJpdmF0ZSBzZWxlY3RlZENvbnRleHQ6IENvbnRleHQ7XG5cdHByaXZhdGUgb1Jlc291cmNlQnVuZGxlOiBSZXNvdXJjZUJ1bmRsZTtcblx0cHJpdmF0ZSBiQ3JlYXRpb246IGJvb2xlYW47XG5cdHByaXZhdGUgaUluZGV4OiBudW1iZXI7XG5cdHByaXZhdGUgYVRlcnJpdG9yeUlkczogc3RyaW5nW10gPSBbXTtcblx0cHJpdmF0ZSBvTW9kaWZpZWRJdGVtcyA9IHt9O1xuXG5cblx0b25Jbml0KCk6IHZvaWQgfCB1bmRlZmluZWQge1xuXHRcdC8vIEluaXRpYWxpemUgd2l0aCBjcmVhdGUgZnJhZ21lbnRcblx0XHR2b2lkIHRoaXMubG9hZEZyYWdtZW50cygnQ3JlYXRlJyk7XG5cblx0XHQvLyBHZXQgSTE4blxuXHRcdGNvbnN0IGkxOG5Nb2RlbCA9ICh0aGlzLmdldE93bmVyQ29tcG9uZW50KCkgYXMgVUlDb21wb25lbnQpLmdldE1vZGVsKFwiaTE4blwiKSBhcyBSZXNvdXJjZU1vZGVsO1xuXHRcdHRoaXMub1Jlc291cmNlQnVuZGxlID0gaTE4bk1vZGVsLmdldFJlc291cmNlQnVuZGxlKCkgYXMgUmVzb3VyY2VCdW5kbGU7XG5cblx0XHQvLyBDcmVhdGUgbG9jYWwgbW9kZWwgdG8gc2VydmUgYXMgdGVtcGxhdGUgZm9yIGNyZWF0aW9uIG9mIE9EYXRhIGVudHJpZXNcblx0XHRjb25zdCBvRGF0YU1vZGVsID0gbmV3IEpTT05Nb2RlbCh7IFRlcnJpdG9yeUlEOiAnJywgVGVycml0b3J5RGVzY3JpcHRpb246ICcnLCBSZWdpb25JRDogMCB9KTtcblx0XHR0aGlzLmdldFZpZXcoKT8uc2V0TW9kZWwob0RhdGFNb2RlbCwgJ29Nb2RlbCcpO1xuXHRcdHRoaXMuYkNyZWF0aW9uID0gdHJ1ZTtcblx0fVxuXG5cdG9uQWZ0ZXJSZW5kZXJpbmcoKTogdm9pZCB8IHVuZGVmaW5lZCB7XG5cdFx0Ly8gVGhpcyBtZXRob2Qgd2FzIGRvbmUgaGVyZSBiZWNhdXNlIG9JdGVtc0JpbmRpbmcgd2FzIHVuZGVmaW5lZCBpZiB2aWV3IHdhc24ndCByZW5kZXJlZFxuXHRcdC8vIEdldCB0aGUgYmluZGluZyBvZiB0eXBlIFYyLk9EYXRhTGlzdEJpbmRpbmcgZm9ybSB0aGUgdGFibGVcblx0XHR0aGlzLm9uR2V0VGVycml0b3J5SWRzKCk7XG5cdH1cblxuXHRwcml2YXRlIG9uR2V0VGVycml0b3J5SWRzKCkge1xuXHRcdGNvbnN0IG9JdGVtc0JpbmRpbmcgPSAodGhpcy5nZXRWaWV3KCk/LmJ5SWQoJ21haW5QYWdlVGFibGUnKSBhcyBUYWJsZSkuZ2V0QmluZGluZygnaXRlbXMnKSBhcyBPRGF0YUxpc3RCaW5kaW5nO1xuXG5cdFx0Ly8gV2hlbiB3ZSByZWNlaXZlIHRoZSBkYXRhIG9uIHRoZSB0YWJsZSBleGVjdXRlIG9uQ3JlYXRlQWN0aXZlRW50cnlcblx0XHRvSXRlbXNCaW5kaW5nLmF0dGFjaERhdGFSZWNlaXZlZCgob0V2ZW50OiBFdmVudCkgPT4ge1xuXHRcdFx0dGhpcy5hVGVycml0b3J5SWRzID0gb0l0ZW1zQmluZGluZy5nZXRDb250ZXh0cygpLm1hcCgob0NvbnRleHQ6IENvbnRleHQpID0+IG9Db250ZXh0LmdldFBhdGgoKSk7XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGxvYWRGcmFnbWVudHMoZnJhZ21lbnROYW1lOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcblxuXHRcdGNvbnN0IG9TaW1wbGVGb3JtID0gKHRoaXMuYnlJZCgnbWFpblNpbXBsZUZvcm0nKSBhcyBTaW1wbGVGb3JtKTtcblx0XHRjb25zdCBvUGFuZWwgPSAodGhpcy5ieUlkKCdtYWluUGFnZVBhbmVsRm9ybScpIGFzIFBhbmVsKTtcblxuXHRcdG9QYW5lbC5zZXRCdXN5KHRydWUpO1xuXHRcdG9TaW1wbGVGb3JtLmRlc3Ryb3lDb250ZW50KCk7IC8vIENsZWFyIGV2ZXJ5dGhpbmcgd2hlbiBhIG5ldyBmcmFnbWVudCBpcyB0byBiZSBsb2FkZWRcblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBhQ29udHJvbCA9IGF3YWl0IEZyYWdtZW50LmxvYWQoe1xuXHRcdFx0XHRuYW1lOiAnbXJnLnNhbXBsZS52aWV3LmZyYWdtZW50cy4nICsgZnJhZ21lbnROYW1lLFxuXHRcdFx0XHRjb250cm9sbGVyOiB0aGlzXG5cdFx0XHR9KSBhcyBDb250cm9sW107XG5cblx0XHRcdGFDb250cm9sLmZvckVhY2goKG9Db250cm9sOiBDb250cm9sKSA9PiB7XG5cdFx0XHRcdG9TaW1wbGVGb3JtLmFkZENvbnRlbnQob0NvbnRyb2wpO1xuXHRcdFx0fSk7XG5cdFx0fSBjYXRjaCAob0Vycm9yKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKGBFcnJvciBsb2FkaW5nIGZyYWdtZW50ICR7ZnJhZ21lbnROYW1lfTpgLCBvRXJyb3IpO1xuXHRcdH0gZmluYWxseSB7XG5cdFx0XHRvUGFuZWwuc2V0QnVzeShmYWxzZSk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBvblByZXNzSXRlbShvRXZlbnQ6IEV2ZW50KSB7XG5cdFx0Ly8gR2V0IHRoZSBpbmRleCBvZiB0aGUgaXRlbSB3ZSBoYXZlIHNlbGVjdGVkIG9uIHRoZSB0YWJsZVxuXHRcdGNvbnN0IHNTZWxlY3RlZFBhdGggPSAob0V2ZW50LmdldFNvdXJjZSgpIGFzIENvbHVtbkxpc3RJdGVtKS5nZXRCaW5kaW5nQ29udGV4dCgnTm9ydGh3aW5kJyk/LmdldFBhdGgoKTtcblx0XHQoKHRoaXMuZ2V0VmlldygpPy5ieUlkKCdtYWluUGFnZVRhYmxlJykgYXMgVGFibGUpLmdldEJpbmRpbmcoJ2l0ZW1zJykgYXMgT0RhdGFMaXN0QmluZGluZyk/LmdldENvbnRleHRzKCkuZm9yRWFjaCgob0NvbnRleHQ6IENvbnRleHQsIGk6IG51bWJlcikgPT4ge1xuXHRcdFx0aWYgKG9Db250ZXh0LmdldFBhdGgoKSA9PT0gc1NlbGVjdGVkUGF0aCkge1xuXHRcdFx0XHR0aGlzLmlJbmRleCA9IGk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBiaW5kIHRoZSBjb250ZXh0IG9uIHRoZSBFZGl0IHBhbmVsIGFuZCBsb2FkIGZyYWdtZW50XG5cdFx0dGhpcy5zZWxlY3RlZENvbnRleHQgPSAob0V2ZW50LmdldFNvdXJjZSgpIGFzIENvbHVtbkxpc3RJdGVtKS5nZXRCaW5kaW5nQ29udGV4dCgnTm9ydGh3aW5kJykgYXMgQ29udGV4dDtcblx0XHR0aGlzLm9uRWRpdChvRXZlbnQpO1xuXHRcdCh0aGlzLmJ5SWQoJ21haW5QYWdlUGFuZWxGb3JtJykgYXMgUGFuZWwpLnNldEV4cGFuZGVkKHRydWUpO1xuXG5cdFx0Ly8gT25jZSB0aGUgaXRlbSBpcyBwcmVzc2VkLCBzY3JvbGwgdXAgdG8gdGhlIHBhbmVsXG5cdFx0KHRoaXMuYnlJZCgnbWFpblBhZ2UnKSBhcyBQYWdlKS5zY3JvbGxUb0VsZW1lbnQodGhpcy5ieUlkKCdtYWluUGFnZVBhbmVsRm9ybScpIGFzIFBhbmVsKTtcblx0fVxuXG5cdHByaXZhdGUgb25DcmVhdGVEcmFmdCgpIHtcblx0XHR0aGlzLm9uQ3JlYXRlSW5hY3RpdmUodHJ1ZSk7XG5cdH1cblxuXHRwcml2YXRlIG9uQ3JlYXRlRW50cnkoKSB7XG5cdFx0dGhpcy5vbkNyZWF0ZUluYWN0aXZlKGZhbHNlKTtcblx0fVxuXG5cdHByaXZhdGUgb25DcmVhdGVJbmFjdGl2ZShiQWN0aXZlOiBib29sZWFuKSB7XG5cdFx0Ly8gSWYgd2UgYXJlIG9uIGVkaXQgbW9kZSwgcmV0dXJuIHRvIGNyZWF0ZSBtb2RlXG5cdFx0aWYgKCF0aGlzLmJDcmVhdGlvbikge1xuXHRcdFx0Ly8gQ2xlYXIgdGhlIG9Nb2RlbCBhdHRhY2hlZCB0byB0aGUgQ3JlYXRlIGZyYWdtZW50IGFuZCBsb2FkIHRoZSBDcmVhdGUgcGFuZWxcblx0XHRcdCh0aGlzLmdldFZpZXcoKT8uZ2V0TW9kZWwoJ29Nb2RlbCcpIGFzIEpTT05Nb2RlbCkuc2V0RGF0YSh7IFRlcnJpdG9yeUlEOiAnJywgVGVycml0b3J5RGVzY3JpcHRpb246ICcnLCBSZWdpb25JRDogMCB9KTtcblx0XHRcdHRoaXMubG9hZEZyYWdtZW50cygnQ3JlYXRlJyk7XG5cblx0XHRcdC8vIFJlYWQgaTE4biBUZXh0c1xuXHRcdFx0Y29uc3Qgc05ld1BhbmVsSGVhZGVyID0gdGhpcy5vUmVzb3VyY2VCdW5kbGUuZ2V0VGV4dCgnY3JlYXRpb25QYW5lbCcpO1xuXHRcdFx0Y29uc3Qgc05ld0J0blRleHREcmFmdCA9IHRoaXMub1Jlc291cmNlQnVuZGxlLmdldFRleHQoJ2FkZEVudHJ5RHJhZnQnKTtcblxuXHRcdFx0Ly8gU2V0IHRleHRzIG9uIGhlYWRlciBhbmQgYnV0dG9uc1xuXHRcdFx0Y29uc3Qgb0J0bkRyYWZ0ID0gKHRoaXMuYnlJZCgnY3JlYXRlRHJhZnRCdG4nKSBhcyBCdXR0b24pO1xuXHRcdFx0Y29uc3Qgb0J0bkNyZWF0ZSA9ICh0aGlzLmJ5SWQoJ2NyZWF0ZUVudHJ5QnRuJykgYXMgQnV0dG9uKTtcblxuXHRcdFx0KHRoaXMuYnlJZCgnbWFpblBhZ2VQYW5lbEZvcm0nKSBhcyBQYW5lbCkuc2V0SGVhZGVyVGV4dChzTmV3UGFuZWxIZWFkZXIpO1xuXHRcdFx0b0J0bkRyYWZ0LnNldFRleHQoc05ld0J0blRleHREcmFmdCk7XG5cdFx0XHRvQnRuRHJhZnQuc2V0SWNvbignc2FwLWljb246Ly9hZGQnKTtcblxuXHRcdFx0b0J0bkNyZWF0ZS5zZXRWaXNpYmxlKHRydWUpO1xuXHRcdFx0KHRoaXMuYnlJZCgnc2F2ZUVudGl0eUJ0bicpIGFzIEJ1dHRvbikuc2V0VmlzaWJsZShmYWxzZSk7XG5cblx0XHRcdC8vIENsZWFyIGNvbnRleHQgYW5kIHNldCBtb2RlOiBjcmVhdGVcblx0XHRcdHRoaXMuc2VsZWN0ZWRDb250ZXh0ID0gdW5kZWZpbmVkO1xuXHRcdFx0dGhpcy5iQ3JlYXRpb24gPSB0cnVlO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIENoZWNrIElEIGlzIGZpbGxlZCBpblxuXHRcdGNvbnN0IG9EYXRhUHJlY2hlY2sgPSAodGhpcy5nZXRWaWV3KCk/LmdldE1vZGVsKCdvTW9kZWwnKSBhcyBKU09OTW9kZWwpLmdldERhdGEoKTtcblx0XHRpZiAob0RhdGFQcmVjaGVjaz8uVGVycml0b3J5SUQgPT09ICcnIHx8IG9EYXRhUHJlY2hlY2s/LlRlcnJpdG9yeUlEID09PSB1bmRlZmluZWQpIHtcblx0XHRcdC8qIFx0XHRcdE1lc3NhZ2VUb2FzdC5zaG93KCdUZXJyaXRvcnkgSWQgbWFuZGF0b3J5IHRvIGJlIHN1cHBsaWVkIScpO1xuXHRcdFx0XHRcdFx0cmV0dXJuOyAqL1xuXHRcdH1cblx0XHRpZiAodGhpcy5hVGVycml0b3J5SWRzLmluY2x1ZGVzKGAvVGVycml0b3JpZXMoJyR7b0RhdGFQcmVjaGVjay5UZXJyaXRvcnlJRH0nKWApKSB7XG5cdFx0XHRNZXNzYWdlVG9hc3Quc2hvdygnVGVycml0b3J5IElkIGFscmVhZHkgZXhpc3RzIScpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmFUZXJyaXRvcnlJZHMucHVzaChgL1RlcnJpdG9yaWVzKCcke29EYXRhUHJlY2hlY2suVGVycml0b3J5SUR9JylgKTtcblx0XHR9XG5cblx0XHQvLyBPbiB0aGUgdGFibGUgY29udGV4dCBhZGQgYSBuZXcgZW50cnkgd2l0aCB0aGUgZGF0YSBmcm9tIG91ciBQYW5lbFxuXHRcdGNvbnN0IG9JdGVtc0JpbmRpbmcgPSAodGhpcy5nZXRWaWV3KCk/LmJ5SWQoJ21haW5QYWdlVGFibGUnKSBhcyBUYWJsZSkuZ2V0QmluZGluZygnaXRlbXMnKSBhcyBPRGF0YUxpc3RCaW5kaW5nO1xuXHRcdGNvbnN0IG9OZXdFbnRyeU1vZGVsID0gdGhpcy5nZXRWaWV3KCk/LmdldE1vZGVsKCdvTW9kZWwnKSBhcyBKU09OTW9kZWw7XG5cdFx0Y29uc3Qgb05ld0VudHJ5T2JqZWN0ID0gb05ld0VudHJ5TW9kZWwuZ2V0RGF0YSgpO1xuXHRcdHRoaXMuc2VsZWN0ZWRDb250ZXh0ID0gb0l0ZW1zQmluZGluZy5jcmVhdGUob05ld0VudHJ5T2JqZWN0LCB0cnVlLCB7IGluYWN0aXZlOiBiQWN0aXZlIH0pIGFzIENvbnRleHQ7XG5cblx0XHQvLyBPbmNlIHRoZSBtb2RlbCBpcyBzZXQgdG8gdGhlIHRhYmxlLCBjbGVhciBpbnB1dCBmaWVsZHMgYW5kIGRpc3BsYXkgbWVzc2FnZVxuXHRcdCh0aGlzLmdldFZpZXcoKT8uZ2V0TW9kZWwoJ29Nb2RlbCcpIGFzIEpTT05Nb2RlbCk/LnNldERhdGEoeyBUZXJyaXRvcnlJRDogJycsIFRlcnJpdG9yeURlc2NyaXB0aW9uOiAnJywgUmVnaW9uSUQ6IDAgfSk7XG5cdFx0TWVzc2FnZVRvYXN0LnNob3coJ0VudHJ5IGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5IScpO1xuXG5cdFx0Ly8gSGlnaGxpZ2h0IGNyZWF0ZWQgZW50cnkgYW5kIGFkZCBpdHMgcG9zaXRpb24gaW50byB0aGlzLm9Nb2RvZmllZEl0ZW1zXG5cdFx0Y29uc3QgYUl0ZW1zID0gKHRoaXMuYnlJZCgnbWFpblBhZ2VUYWJsZScpIGFzIFRhYmxlKS5nZXRJdGVtcygpIGFzIENvbHVtbkxpc3RJdGVtW107XG5cdFx0Y29uc3QgaUxhc3RJdGVtSW5kZXggPSBhSXRlbXMubGVuZ3RoIC0gMTtcblx0XHRjb25zdCBvTGFzdENvbHVtbkxpc3RJdGVtID0gYUl0ZW1zW2lMYXN0SXRlbUluZGV4XSBhcyBDb2x1bW5MaXN0SXRlbTtcblx0XHR0aGlzLmhpZ2hsaWdodEl0ZW0ob0xhc3RDb2x1bW5MaXN0SXRlbSwgYkFjdGl2ZSA/ICdFcnJvcicgOiAnTm9uZScsIGlMYXN0SXRlbUluZGV4LCB0aGlzLnNlbGVjdGVkQ29udGV4dC5nZXRQYXRoKCkpO1xuXHR9XG5cblx0cHJpdmF0ZSBvbkVkaXQob0V2ZW50OiBFdmVudCkge1xuXG5cdFx0Ly8gQmluZCB0aGUgY29udGV4dCBvZiB0aGUgY3VycmVudCBlbnRyeSB0byB0aGUgc2ltcGxlIGZvcm1cblx0XHRpZiAodGhpcy5zZWxlY3RlZENvbnRleHQgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0KHRoaXMuYnlJZCgnbWFpblNpbXBsZUZvcm0nKSBhcyBTaW1wbGVGb3JtKS5zZXRCaW5kaW5nQ29udGV4dCh0aGlzLnNlbGVjdGVkQ29udGV4dCwgJ05vcnRod2luZCcpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRNZXNzYWdlVG9hc3Quc2hvdygnUGxlYXNlIHNlbGVjdCBhbiBlbnRyeSB0byBiZSBlZGl0ZWQnKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBTZXQgdGhlIHBhbmVsIGZyYWdtZW50IGZvciBlZGl0aW9uXG5cdFx0dGhpcy5sb2FkRnJhZ21lbnRzKCdFZGl0Jyk7XG5cblx0XHQvLyBDaGFuZ2UgdGV4dHMsIGljb25zIGFuZCBoaWRlIGJ1dHRvbnNcblx0XHRjb25zdCBzTmV3UGFuZWxIZWFkZXIgPSB0aGlzLm9SZXNvdXJjZUJ1bmRsZS5nZXRUZXh0KCdlZGl0aW9uUGFuZWwnKTtcblx0XHRjb25zdCBzTmV3QnRuVGV4dCA9IHRoaXMub1Jlc291cmNlQnVuZGxlLmdldFRleHQoJ2VudHJ5Q3JlYXRpb24nKTtcblxuXHRcdCh0aGlzLmJ5SWQoJ21haW5QYWdlUGFuZWxGb3JtJykgYXMgUGFuZWwpLnNldEhlYWRlclRleHQoc05ld1BhbmVsSGVhZGVyKTtcblx0XHQodGhpcy5ieUlkKCdzYXZlRW50aXR5QnRuJykgYXMgQnV0dG9uKS5zZXRWaXNpYmxlKHRydWUpO1xuXHRcdCh0aGlzLmJ5SWQoJ2NyZWF0ZUVudHJ5QnRuJykgYXMgQnV0dG9uKS5zZXRWaXNpYmxlKGZhbHNlKTtcblxuXHRcdGNvbnN0IG9CdG4gPSAodGhpcy5ieUlkKCdjcmVhdGVEcmFmdEJ0bicpIGFzIEJ1dHRvbik7XG5cdFx0b0J0bi5zZXRUZXh0KHNOZXdCdG5UZXh0KTtcblx0XHRvQnRuLnNldEljb24oJ3NhcC1pY29uOi8vY3JlYXRlJyk7XG5cblx0XHR0aGlzLmJDcmVhdGlvbiA9IGZhbHNlO1xuXHR9XG5cblx0cHJpdmF0ZSBvblNhdmUoKSB7XG5cblx0XHQvLyBPYmplY3QgdG8gYmUgbW9kaWZpZWRcblx0XHRjb25zdCBvQ29sdW1uTGlzdEl0ZW0gPSAoKCh0aGlzLmJ5SWQoJ21haW5QYWdlVGFibGUnKSBhcyBUYWJsZSkuZ2V0SXRlbXMoKSBhcyBDb2x1bW5MaXN0SXRlbVtdKVt0aGlzLmlJbmRleF0gYXMgQ29sdW1uTGlzdEl0ZW0pO1xuXHRcdGNvbnN0IG9EYXRhID0gKHRoaXMuc2VsZWN0ZWRDb250ZXh0IGFzIENvbnRleHQpLmdldE9iamVjdCgpO1xuXHRcdGNvbnN0IHNQYXRoID0gKHRoaXMuc2VsZWN0ZWRDb250ZXh0IGFzIENvbnRleHQpLmdldFBhdGgoKTtcblxuXHRcdC8vIEhpZ2hsaWdodCB0aGlzIGVudHJ5IGFzIG1vZGlmaWVkIGFuZCBzYXZlIGluZm9ybWF0aW9uIG9uIHRoaXMub01vZGlmaWVkSXRlbXNcblx0XHR0aGlzLmhpZ2hsaWdodEl0ZW0ob0NvbHVtbkxpc3RJdGVtLCAnRXJyb3InLCB0aGlzLmlJbmRleCwgc1BhdGgpO1xuXG5cdFx0Ly8gb0RhdGEgaG9sZHMgdGhlIG9sZCBkYXRhIGZvciB0aGlzIGVudHJ5LCB3ZSBhcmUgZ29pbmcgdG8gdXBkYXRlIHBvc3NpYmxlIHZhbHVlcyBcblx0XHQob0RhdGEgYXMgYW55KS5UZXJyaXRvcnlEZXNjcmlwdGlvbiA9ICh0aGlzLmJ5SWQoJ3RlcnJpdG9yeURlc2NyaXB0aW9uSW5wdXRFZGl0JykgYXMgSW5wdXQpLmdldFZhbHVlKCkgYXMgc3RyaW5nO1xuXHRcdChvRGF0YSBhcyBhbnkpLlJlZ2lvbklEID0gKHRoaXMuYnlJZCgnUmVnaW9uSW5wdXRFZGl0JykgYXMgSW5wdXQpLmdldFZhbHVlKCkgYXMgc3RyaW5nO1xuXG5cdFx0Ly8gVG8gYWN0aXZhdGUgdGhlIGluYWN0aXZlIGVudHJ5LCBnZXQgdGhlIG1vZGVsIGFuZCBzZXQgYSBwcm9wZXJ0eSB0byB0aGUgc2FtZSB2YWx1ZVxuXHRcdGNvbnN0IG9Ob3J0aHdpbmRNb2RlbCA9ICgodGhpcy5nZXRPd25lckNvbXBvbmVudCgpIGFzIFVJQ29tcG9uZW50KS5nZXRNb2RlbCgnTm9ydGh3aW5kJykgYXMgT0RhdGFNb2RlbCk7XG5cdFx0b05vcnRod2luZE1vZGVsLnNldFByb3BlcnR5KCdUZXJyaXRvcnlEZXNjcmlwdGlvbicsIChvRGF0YSBhcyBhbnkpLlRlcnJpdG9yeURlc2NyaXB0aW9uLCB0aGlzLnNlbGVjdGVkQ29udGV4dCwgdHJ1ZSk7XG5cdFx0Y29uc29sZS5sb2codGhpcy5zZWxlY3RlZENvbnRleHQuaXNJbmFjdGl2ZSgpKTtcblx0fVxuXG5cdHByaXZhdGUgaGlnaGxpZ2h0SXRlbShvSXRlbTogQ29sdW1uTGlzdEl0ZW0sIHNNb2RlOiBzdHJpbmcsIGlJbmRleD86IG51bWJlciwgc1BhdGg/OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRpZiAoc01vZGUgIT09ICdFcnJvcicgJiYgc01vZGUgIT09ICdOb25lJykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdzTW9kZSBwYXJhbWV0ZXIgaGFzIGludmFsaWQgdmFsdWUnKTtcblx0XHR9XG5cdFx0b0l0ZW0uc2V0SGlnaGxpZ2h0KHNNb2RlKTtcblx0XHRpZiAoIU51bWJlci5pc05hTihpSW5kZXgpKSB7XG5cdFx0XHQodGhpcy5vTW9kaWZpZWRJdGVtcyBhcyBhbnkpW3NQYXRoXSA9IHsgaW5hY3RpdmU6IHNNb2RlID09PSAnRXJyb3InID8gdHJ1ZSA6IGZhbHNlLCB0YWJsZUluZGV4OiBpSW5kZXggfTtcblx0XHRcdGNvbnNvbGUubG9nKHRoaXMub01vZGlmaWVkSXRlbXMpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ2lJbmRleCBpcyBub3QgYSBudW1iZXInKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIG9uU3VibWl0KCkge1xuXHRcdGNvbnN0IG9Ob3J0aHdpbmRNb2RlbCA9ICgodGhpcy5nZXRPd25lckNvbXBvbmVudCgpIGFzIFVJQ29tcG9uZW50KS5nZXRNb2RlbCgnTm9ydGh3aW5kJykgYXMgT0Rh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